<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.7.181" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="40110,3530635764" ReportOptions.Description.Text="" ReportOptions.LastChange="43923,5748692014" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;procedure btnAtualizarOnClick(Sender: TfrxComponent);&#13;&#10;begin          &#13;&#10;                                &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  qryUpdateMovimentacoes.Close;        &#13;&#10;  qryUpdateMovimentacoes.SQL.ADD( 'CODIGO IN(                                           '+    &#13;&#10;                                  '        SELECT CODIGO FROM MOVIMENTACOES_BLOQUEIO    '+  &#13;&#10;                                  '        WHERE CODIGO_CONSISTENCIA IN(11, 12, 14, 44, 45, 46)               '+   &#13;&#10;                                  '        AND CODIGO_MOVIMENTACAO IN     '+ VarToStr(&#60;CODIGOS_MOVIMENTO&#62;)+       &#13;&#10;                                  '                            )' );&#13;&#10;  qryUpdateMovimentacoes.SQL.ADD( 'select '''' ');      &#13;&#10;   qryUpdateMovimentacoes.Open;     &#13;&#10;&#13;&#10;  qryUpdateSequencia.Close;                                                                                                                                &#13;&#10;  qryUpdateSequencia.SQL.ADD( 'CODIGO IN( SELECT CODIGO_MOVIMENTACAO				                                                                         '+        &#13;&#10;                              '            FROM MOVIMENTACOES_BLOQUEIO                                                                           '+  &#13;&#10;               				           '            WHERE CODIGO_MOVIMENTACAO IN             '+ VarToStr(&#60;CODIGOS_MOVIMENTO&#62;)+    &#13;&#10;			                           '          	 GROUP BY CODIGO_MOVIMENTACAO                                                                          '+  &#13;&#10;		                            ' 	        	 HAVING COUNT(STATUS) =(SELECT COUNT(STATUS) FROM MOVIMENTACOES_BLOQUEIO MB                            '+    &#13;&#10;                              '                                   WHERE MB.CODIGO_MOVIMENTACAO = MOVIMENTACOES_BLOQUEIO.CODIGO_MOVIMENTACAO      '+  &#13;&#10;                              '                                   AND MB.STATUS = 0 )                                                            '+  &#13;&#10;		       		                   '           	)     ' );&#13;&#10;  qryUpdateSequencia.SQL.ADD( 'select '''' ');      &#13;&#10;  qryUpdateSequencia.Open;  &#13;&#10;    &#13;&#10;  //  qryUpdateMovimentacoes.ExecSQL;&#13;&#10;  //              &#13;&#10;  //   showMessage(qryUpdateMovimentacoes.sql.Text);&#13;&#10;  //    showMessage(qryUpdateSequencia.sql.Text);        &#13;&#10;    &#13;&#10;end.                                " PropData="08446174617365747301010C4600000020446174615365743D227172795570646174654D6F76696D656E7461636F65732220446174615365744E616D653D227172795570646174654D6F76696D656E7461636F65732200010C4200000020446174615365743D22717279436F6E646963616F506167616D656E746F2220446174615365744E616D653D22717279436F6E646963616F506167616D656E746F2200010C3600000020446174615365743D2271727943656E74726F437573746F2220446174615365744E616D653D2271727943656E74726F437573746F2200010C2C00000020446174615365743D2241444F5175657279312220446174615365744E616D653D2241444F5175657279312200010C3E00000020446174615365743D2271727955706461746553657175656E6369612220446174615365744E616D653D2271727955706461746553657175656E636961220000095661726961626C657301010C1A000000204E616D653D2220434F4449474F535F4D4F56494D454E544F2200010C19000000204E616D653D22434F4449474F535F4D4F56494D454E544F2200010C1F000000204E616D653D22434F4449474F5F46494C49414C222056616C75653D22312200010C21000000204E616D653D22434F4449474F5F434F4C4947414441222056616C75653D22312200010C22000000204E616D653D22434F4449474F5F5553554152494F222056616C75653D22313133220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxADODatabase Name="ADODatabase1" DatabaseName="Provider=SQLOLEDB.1;Password=@rr0b4;Persist Security Info=True;User ID=sa;Initial Catalog=MSE;Data Source=PINKFLOYD;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=PINKFLOYD;Use Encryption for Data=False;Tag with column collation when possible=False" LoginPrompt="False" Connected="True" PropData="05704C65667402500470546F700244"/>
    <TfrxADOQuery Name="qryUpdateMovimentacoes" UserName="qryUpdateMovimentacoes" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="True" IgnoreDupParams="False" SQL.Text="UPDATE MOVIMENTACOES_BLOQUEIO SET USUARIO_LIBERACAO = 87, DATA_DESBLOQUEIO = GETDATE(), MOTIVO_LIBERACAO = 'APROVADO', STATUS = 0&#13;&#10;WHERE                                                   " CommandTimeout="30" Database="ADODatabase1" LockType="ltReadOnly" PropData="05704C65667402580470546F70038B000A506172616D65746572730100"/>
    <TfrxADOQuery Name="qryCondicaoPagamento" UserName="qryCondicaoPagamento" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select CODIGO,&#13;&#10;	   DESCRICAO &#13;&#10;from CONDICOESPAGAMENTO &#13;&#10;where DESCRICAO is not null&#13;&#10;order by DESCRICAO                  " CommandTimeout="30" Database="ADODatabase1" LockType="ltReadOnly" PropData="05704C65667403ED010470546F7002430A506172616D65746572730100"/>
    <TfrxADOQuery Name="qryCentroCusto" UserName="qryCentroCusto" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT (ABREVIATURA +'  '+NOME) AS CC,CODIGO FROM GCENTROCUSTO &#13;&#10;ORDER BY NOME                  " CommandTimeout="30" Database="ADODatabase1" LockType="ltReadOnly" PropData="05704C6566740383010470546F7002440A506172616D65746572730100"/>
    <TfrxADOQuery Name="ADOQuery1" UserName="ADOQuery1" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="UPDATE MOVIMENTACOES_BLOQUEIO SET USUARIO_LIBERACAO = 87, DATA_DESBLOQUEIO = GETDATE(), MOTIVO_LIBERACAO = 'APROVADO', STATUS = 0&#13;&#10;WHERE                                                   " CommandTimeout="30" Database="ADODatabase1" LockType="ltReadOnly" PropData="05704C6566740318030470546F700364FF0A506172616D65746572730100"/>
    <TfrxADOQuery Name="qryUpdateSequencia" UserName="qryUpdateSequencia" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="UPDATE MOVIMENTACOES SET BLOQUEADO = 0&#13;&#10;WHERE                                                    " CommandTimeout="30" Database="ADODatabase1" LockType="ltReadOnly" PropData="05704C65667402580470546F7003C8000A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="308" PaperSize="256" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxMemoView Name="Memo1" Left="0,76923076" Top="34,61538462" Width="716,79594231" Height="118,12841923" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-48" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="APROVADO"/>
  </TfrxReportPage>
</TfrxReport>